<?xml version="1.0" encoding="utf-8"?>
<mx:Module xmlns:fx="http://ns.adobe.com/mxml/2009" 
		   xmlns:s="library://ns.adobe.com/flex/spark" 
		   xmlns:mx="library://ns.adobe.com/flex/mx" layout="vertical" width="100%" height="100%"
		   xmlns:content="oa.receipt.component.*" creationComplete="init()">
	<fx:Script>
		<![CDATA[
			import mx.controls.Alert;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			import mx.collections.ArrayCollection;
			
			import oa.entity.receipt.ReceiptModel;
			
			public var receipt:ReceiptModel = new ReceiptModel();
			public var _hao:String;
			public var _zi:String;
			public var in_date:String;
			public var inNumber:String;
			public var subject:String;
			public var office:String;
			public var status:int;
			
			private function init():void
			{
				var parms:String=((Object)(this.owner)).id;
				Alert.show("devise detail :" + parms);
				receiptServiceRO.get(parms);
			}
			
			protected function receiptServiceGet_result(event:ResultEvent):void
			{
				// TODO Auto-generated method stub
				// for first page
				receipt = event.result as ReceiptModel;
				receipt_text.title.text = receipt.title;
				receipt_text.summary.text = receipt.summary;
				receipt_text.title.enabled = false;
				receipt_text.summary.enabled = false;
				receipt_text.title_string_validate.triggerEvent = "";
				receipt_text.summary_string_validate.triggerEvent = "";
				var number:Array = receipt.doNumber.split("+");
				_hao = number.pop();
				_zi = number.pop();
				if(receipt.inDate != null)
					in_date = receipt.inDate.fullYear + "-" + receipt.inDate.month + '-' + receipt.inDate.day;
				inNumber = receipt.inNumber;
				subject = receipt.subject;
				office = receipt.office;
				status = receipt.status;
				//for attments
				var list:ArrayCollection = receipt.attachments as ArrayCollection;
				receipt_text.list = list;
			}
			
			protected function faultHandler(event:FaultEvent):void
			{
				// TODO Auto-generated method stub
				Alert.show(event.fault.faultString, 'Error');
			}
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
		<s:RemoteObject concurrency="last" destination="receiptServiceDest" id="receiptServiceRO" fault="faultHandler(event)" showBusyCursor="true">
			<s:method concurrency="last" name="get" result="receiptServiceGet_result(event)"/>
		</s:RemoteObject>
	</fx:Declarations>
	<mx:TabNavigator width="100%" height="100%">
		<s:NavigatorContent label="来文正文" width="100%" height="100%">
			<content:receiptText width="100%" id="receipt_text"/>
		</s:NavigatorContent>
		<s:NavigatorContent label="来文登记单" width="100%" height="100%">
			<content:DeviseDetail width="100%" id="receipt_file"/>
		</s:NavigatorContent>
	</mx:TabNavigator>
</mx:Module>
