<?xml version="1.0" encoding="utf-8"?>
<mx:Module xmlns:fx="http://ns.adobe.com/mxml/2009" 
		   xmlns:s="library://ns.adobe.com/flex/spark" 
		   xmlns:mx="library://ns.adobe.com/flex/mx" layout="vertical" width="100%" height="100%"  creationComplete="init();" verticalAlign="middle" horizontalAlign="center">
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
		<mx:StringValidator id="oldPW_stringValidator" source="{oldPW}" property="text"  requiredFieldError="原密码不能为空"/>
		<mx:StringValidator id="newPW_stringValidator" source="{newPW}" property="text"  requiredFieldError="新密码不能为空"/>
		<mx:StringValidator id="newPWConfirm_stringValidator" source="{newPWConfirm}" property="text"  requiredFieldError="前后密码不一致"/>

	</fx:Declarations>
	<fx:Script> 
		
		<![CDATA[  
			
			import mx.managers.PopUpManager;
			import mx.core.FlexGlobals;
			import mx.events.ValidationResultEvent;
			import mx.validators.Validator;
			import mx.controls.Alert;
			import system.component.WlzxLockWin;
			private var validatorArr:Array;
			private function init():void
			{
				validatorArr = new Array();
				validatorArr.push(oldPW_stringValidator);
				validatorArr.push(newPW_stringValidator);
				validatorArr.push(newPWConfirm_stringValidator);	
			} 
			private function validateForm(evt:MouseEvent):void {
				var validatorErrorArray:Array = Validator.validateAll(validatorArr);;
				var isValidForm:Boolean = validatorErrorArray.length == 0;
				if (isValidForm) {
					lockWin();
				} else {
					var err:ValidationResultEvent;
					var errorMessageArray:Array = [];
					for each (err in validatorErrorArray) {
						var errField:String = FormItem(err.currentTarget.source.parent).label
						errorMessageArray.push(errField + ": " + err.message);
					}
					Alert.show(errorMessageArray.join("\n\n"), "请按照以下提示信息重新填写", Alert.OK);
				}
			}
			private var window:WlzxLockWin=null;
			
			private function lockWin():void{
				if(window==null)window=new WlzxLockWin();
				PopUpManager.addPopUp(window,this,true);
							
				PopUpManager.centerPopUp(window); 
			}
			private function unLockWin():void{
				if(window!=null)
					PopUpManager.removePopUp(window);
			}
		]]> 
		
	</fx:Script> 
	<s:Panel width="100%" height="100%" title="密码修改"  skinClass="system.skins.WlzxPanelSkin"   borderVisible="true" dropShadowVisible="false">

	<mx:Form  width="100%" height="100%" >
		<mx:FormItem label="原密码：" required="true" width="350">
			<s:TextInput width="70%" id="oldPW"/>
		</mx:FormItem>
		<mx:FormItem label="新密码：" required="true" width="350">
			<s:TextInput width="70%" id="newPW"/>
		</mx:FormItem>
		<mx:FormItem label="新密码确认：" required="true" width="350">
			<s:TextInput width="70%" id="newPWConfirm"/>
		</mx:FormItem>
		<mx:FormItem  horizontalAlign="right" width="350">
			<s:Button label="保存" click="validateForm(event);"/>
		</mx:FormItem>
	</mx:Form>
	</s:Panel>

</mx:Module>
