<?xml version="1.0" encoding="utf-8"?>
<mx:Module xmlns:fx="http://ns.adobe.com/mxml/2009" 
		   xmlns:s="library://ns.adobe.com/flex/spark" 
		   xmlns:mx="library://ns.adobe.com/flex/mx" layout="vertical" width="100%" height="100%"
		   xmlns:content="oa.receipt.component.*" 
		   xmlns:valueObjects="oa.entity.receipt.*" creationComplete="init()">
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import mx.containers.FormItem;
			import mx.controls.Alert;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			private function init():void
			{
				var id:String = this.id;
				receiptServiceRO.get(id);
			}
			
			protected function receiptServiceGet_result(event:ResultEvent):void
			{
				// TODO Auto-generated method stub
				// for first page 
				receipt = event.result as ReceiptModel;
				Alert.show(receipt.title);
				receipt_text.title.text = receipt.title;
				receipt_text.summary.text = receipt.summary;
				var number:Array = receipt.doNumber.split("+");
				receipt_file.zhutici.text = number.pop();
				receipt_file._zi.text = number.pop();
				if(receipt.inDate != null)
					receipt_file.in_date.text = receipt.inDate.fullYear + "-" + receipt.inDate.month + '-' + receipt.inDate.day;
				receipt_file.in_number.text = receipt.inNumber;
				receipt_file.zhutici.text = receipt.subject;
				receipt_text.title.text = receipt.title;
				receipt_file.in_department.text = receipt.office;
				//attachments here
			}
			
			protected function faultHandler(event:FaultEvent):void
			{
				// TODO Auto-generated method stub
				Alert.show(event.fault.faultString, 'Error');
			}
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
		<s:RemoteObject concurrency="last" destination="receiptServiceDest" id="receiptServiceRO" fault="faultHandler(event)" showBusyCursor="true">
			<s:method concurrency="last" name="get" result="receiptServiceGet_result(event)"/>
		</s:RemoteObject>
		<valueObjects:ReceiptModel id="receipt"/>
	</fx:Declarations>
	<mx:TabNavigator width="100%" height="100%">
		<s:NavigatorContent label="来文正文" width="100%" height="100%">
			<content:receiptText width="100%" id="receipt_text"/>
		</s:NavigatorContent>
		<s:NavigatorContent label="来文登记单" width="100%" height="100%">
			<content:receiptFile width="100%" id="receipt_file"/>
		</s:NavigatorContent>
	</mx:TabNavigator>
</mx:Module>
