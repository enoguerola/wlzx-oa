<?xml version="1.0" encoding="utf-8"?>
<s:MXDataGridItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
						  xmlns:s="library://ns.adobe.com/flex/spark" 
						  xmlns:mx="library://ns.adobe.com/flex/mx" 
						  focusEnabled="true" creationComplete="init()">
	<fx:Declarations>
		<s:RemoteObject concurrency="last" id="receiptServiceRO" destination="receiptServiceRest" fault="receiptServiceRO_faultHandler(event)">
			<s:method concurrency="last" name="remove" result="remove_resultHandler(event)"/>
		</s:RemoteObject>
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import mx.controls.Alert;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			import mx.events.CloseEvent;
			
			private var step:String;
		
			private function init():void
			{
				var parent:Object=(Object)(((Object)(((Object)(this.owner)).owner)).owner);
				if(parent.id == "register_grid"){
					Alert.show("register");
					remove_button.label = "删除";
					step = this.data.step;
					edit_button.visible = true;
				}
			}
			
			protected function edit(id:String):void
			{
				// TODO Auto-generated method stub
				var parent:Object = ((Object)(this.parentDocument)).parentDocument;
				parent.add(id);
			}
			
			protected function remove(id:String):void
			{
				// TODO Auto-generated method stub
				Alert.show("你确定要删除该公告吗?", "确定" ,Alert.YES | Alert.NO,null,function(event:CloseEvent):void{
					if(event.detail == Alert.YES)
					{
						receiptServiceRO.remove(id);
					}
				});
			}

			protected function receiptServiceRO_faultHandler(event:FaultEvent):void
			{
				// TODO Auto-generated method stub
				Alert.show(event.fault.faultString, "Error");
			}
			
			protected function remove_resultHandler(event:ResultEvent):void
			{
				// TODO Auto-generated method stub
				var parent:Object = (Object)((Object)(this.owner)).owner;
				parent.search();
			}

		]]>
	</fx:Script>
	<s:HGroup horizontalAlign="center" verticalAlign="middle" width="100%" height="100%">
		<mx:LinkButton click="{remove(data.id)}" id="remove_button"/>
		<mx:LinkButton click="{edit(data.id)}" id="edit_button" visible="false" label="编辑"/>
	</s:HGroup>
</s:MXDataGridItemRenderer>
